name: Build Windows EXE (Enhanced Compatibility)

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  build-windows-exe:
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
        architecture: 'x64'
    
    - name: Install dependencies with error handling
      run: |
        python -m pip install --upgrade pip
        # å®‰è£…ä¾èµ–æ—¶æ·»åŠ é”™è¯¯å¤„ç†
        try {
          pip install pyinstaller
          pip install -r requirements.txt
          Write-Host "âœ… ä¾èµ–å®‰è£…æˆåŠŸ"
        } catch {
          Write-Host "âŒ ä¾èµ–å®‰è£…å¤±è´¥: $($_.Exception.Message)"
          Write-Host "ğŸ”„ å°è¯•ä½¿ç”¨å¤‡ç”¨æ–¹æ³•å®‰è£…..."
          pip install --upgrade pip setuptools wheel
          pip install --only-binary=all -r requirements.txt
        }
    
    - name: Build EXE with PyInstaller
      run: |
        Write-Host "ğŸ”¨ å¼€å§‹æ„å»ºWindowså¯æ‰§è¡Œæ–‡ä»¶..."
        pyinstaller --clean --noconfirm "DHI_Screening_System_v3.0.spec"
        
        # éªŒè¯æ„å»ºç»“æœ
        $exePath = "dist\DHI_Screening_System_v3.0\DHI_Screening_System_v3.0.exe"
        if (Test-Path $exePath) {
          $fileSize = (Get-Item $exePath).Length / 1MB
          Write-Host "âœ… EXEæ„å»ºæˆåŠŸ: $([math]::Round($fileSize, 2)) MB"
        } else {
          Write-Host "âŒ EXEæ„å»ºå¤±è´¥"
          exit 1
        }
    
    - name: Install Inno Setup
      run: |
        Write-Host "ğŸ“¥ ä¸‹è½½å¹¶å®‰è£…Inno Setup..."
        $url = "https://files.jrsoftware.org/is/6/innosetup-6.2.2.exe"
        $output = "innosetup-installer.exe"
        try {
          Invoke-WebRequest -Uri $url -OutFile $output
          Start-Process -FilePath $output -ArgumentList "/VERYSILENT", "/SUPPRESSMSGBOXES", "/NORESTART" -Wait
          $env:PATH += ";C:\Program Files (x86)\Inno Setup 6"
          echo "C:\Program Files (x86)\Inno Setup 6" >> $env:GITHUB_PATH
          Write-Host "âœ… Inno Setupå®‰è£…æˆåŠŸ"
        } catch {
          Write-Host "âŒ Inno Setupå®‰è£…å¤±è´¥: $($_.Exception.Message)"
          exit 1
        }
        
    - name: Create Enhanced Installer Script
      run: |
        Write-Host "ğŸ“ åˆ›å»ºå¢å¼ºå…¼å®¹æ€§å®‰è£…è„šæœ¬..."
        
        # åˆ›å»ºå®‰è£…è„šæœ¬å†…å®¹
        "; DHIç­›æŸ¥åˆ†æç³»ç»Ÿ v3.0 - å¢å¼ºå…¼å®¹æ€§å®‰è£…ç¨‹åº" | Out-File "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; ä¼Šåˆ©æ¶²å¥¶å¥¶ç§‘é™¢" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; æ”¯æŒWindows 7/8/10/11 (64ä½)" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "#define MyAppNameChinese `"DHIç­›æŸ¥åˆ†æç³»ç»Ÿ`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "#define MyAppVersion `"3.0`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "#define MyAppPublisher `"ä¼Šåˆ©æ¶²å¥¶å¥¶ç§‘é™¢`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "#define MyAppExeName `"DHI_Screening_System_v3.0.exe`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "[Setup]" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "AppId={{B6F5E7D4-8A2C-4F1B-9E3D-7A6C8B9D0E1F}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "AppName={#MyAppNameChinese}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "AppVersion={#MyAppVersion}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "AppVerName={#MyAppNameChinese} v{#MyAppVersion}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "AppPublisher={#MyAppPublisher}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "AppCopyright=Copyright (C) 2025 {#MyAppPublisher}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; å¢å¼ºå…¼å®¹æ€§è®¾ç½®" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "DefaultDirName={autopf}\{#MyAppNameChinese}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "DefaultGroupName={#MyAppNameChinese}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "AllowNoIcons=yes" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "OutputDir=installer" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "OutputBaseFilename=DHI_Screening_System_v{#MyAppVersion}_Enhanced_Setup" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "SetupIconFile=whg3r-qi1nv-001.ico" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Compression=lzma" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "SolidCompression=yes" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "WizardStyle=modern" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; æ”¯æŒWindows 7åŠä»¥ä¸Š (64ä½)" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "MinVersion=6.1" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "ArchitecturesAllowed=x64" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "ArchitecturesInstallIn64BitMode=x64" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; æƒé™è®¾ç½®" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "PrivilegesRequired=admin" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "PrivilegesRequiredOverridesAllowed=commandline" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; å¸è½½è®¾ç½®" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "UninstallDisplayIcon={app}\{#MyAppExeName}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "UninstallDisplayName={#MyAppNameChinese} v{#MyAppVersion}" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "[Languages]" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Name: `"english`"; MessagesFile: `"compiler:Default.isl`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "[Tasks]" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Name: `"desktopicon`"; Description: `"{cm:CreateDesktopIcon}`"; GroupDescription: `"{cm:AdditionalIcons}`"; Flags: unchecked" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "[Files]" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; ä¸»ç¨‹åºæ–‡ä»¶" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Source: `"dist\DHI_Screening_System_v3.0\*`"; DestDir: `"{app}`"; Flags: ignoreversion recursesubdirs createallsubdirs" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; æ–‡æ¡£æ–‡ä»¶" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Source: `"README.md`"; DestDir: `"{app}`"; Flags: ignoreversion" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Source: `"LICENSE.txt`"; DestDir: `"{app}`"; Flags: ignoreversion skipifsourcedoesntexist" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Source: `"whg3r-qi1nv-001.ico`"; DestDir: `"{app}`"; Flags: ignoreversion" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "[Icons]" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; å¼€å§‹èœå•" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Name: `"{group}\{#MyAppNameChinese}`"; Filename: `"{app}\{#MyAppExeName}`"; IconFilename: `"{app}\whg3r-qi1nv-001.ico`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Name: `"{group}\æ“ä½œè¯´æ˜`"; Filename: `"{app}\README.md`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Name: `"{group}\å¸è½½ {#MyAppNameChinese}`"; Filename: `"{uninstallexe}`"" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; æ¡Œé¢å¿«æ·æ–¹å¼" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Name: `"{autodesktop}\{#MyAppNameChinese}`"; Filename: `"{app}\{#MyAppExeName}`"; IconFilename: `"{app}\whg3r-qi1nv-001.ico`"; Tasks: desktopicon" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "[Run]" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "; å®‰è£…å®Œæˆåè¿è¡Œé€‰é¡¹" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        "Filename: `"{app}\{#MyAppExeName}`"; Description: `"{cm:LaunchProgram,{#StringChange(MyAppNameChinese, '&', '&&')}}`"; Flags: nowait postinstall skipifsilent" | Add-Content "DHI_Enhanced_Setup.iss" -Encoding UTF8
        
        Write-Host "âœ… å®‰è£…è„šæœ¬åˆ›å»ºå®Œæˆ"
        
    - name: Create Enhanced Installer
      run: |
        if (-not (Test-Path "installer")) {
          New-Item -ItemType Directory -Path "installer"
        }
        
        $isccPath = "C:\Program Files (x86)\Inno Setup 6\ISCC.exe"
        Write-Host "ğŸ”¨ åˆ›å»ºå¢å¼ºå…¼å®¹æ€§å®‰è£…åŒ…..."
        
        try {
          & $isccPath "DHI_Enhanced_Setup.iss"
          if ($LASTEXITCODE -eq 0) {
            Write-Host "âœ… å®‰è£…åŒ…åˆ›å»ºæˆåŠŸ"
            $installerPath = "installer\DHI_Screening_System_v3.0_Enhanced_Setup.exe"
            if (Test-Path $installerPath) {
              $fileSize = (Get-Item $installerPath).Length / 1MB
              Write-Host "ğŸ“¦ å®‰è£…åŒ…å¤§å°: $([math]::Round($fileSize, 2)) MB"
            }
          } else {
            throw "Inno Setupç¼–è¯‘å¤±è´¥ï¼Œé€€å‡ºä»£ç : $LASTEXITCODE"
          }
        } catch {
          Write-Host "âŒ å®‰è£…åŒ…åˆ›å»ºå¤±è´¥: $($_.Exception.Message)"
          exit 1
        }
        
    - name: Create Portable Version
      run: |
        Write-Host "ğŸ“¦ åˆ›å»ºä¾¿æºç‰ˆæœ¬..."
        
        if (-not (Test-Path "release")) {
          New-Item -ItemType Directory -Path "release"
        }
        
        # å¤åˆ¶ç¨‹åºæ–‡ä»¶
        xcopy "dist\DHI_Screening_System_v3.0" "release\DHI_Screening_System_v3.0_Portable" /E /I /Y
        
        # å¤åˆ¶æ–‡æ¡£
        xcopy "README.md" "release\" /Y
        xcopy "LICENSE.txt" "release\" /Y
        
        # åˆ›å»ºä¾¿æºç‰ˆè¯´æ˜
        "# DHIç­›æŸ¥åˆ†æç³»ç»Ÿ v3.0 - ä¾¿æºç‰ˆ" | Out-File "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "## ä½¿ç”¨è¯´æ˜" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "1. è§£å‹åˆ°ä»»æ„ç›®å½•" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "2. è¿è¡Œ DHI_Screening_System_v3.0.exe" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "3. æ— éœ€å®‰è£…ï¼Œæ— éœ€ç®¡ç†å‘˜æƒé™" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "## ç³»ç»Ÿè¦æ±‚" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "- Windows 7/8/10/11 (64ä½)" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "- 4GB RAM (æ¨è8GB)" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "- 500MB å¯ç”¨ç£ç›˜ç©ºé—´" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "## æ³¨æ„äº‹é¡¹" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "- ä¾¿æºç‰ˆæ•°æ®ä¿å­˜åœ¨ç¨‹åºç›®å½•ä¸‹" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "- å»ºè®®è§£å‹åˆ°éç³»ç»Ÿç›˜ä½¿ç”¨" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "- å¦‚éœ€å¸è½½ï¼Œç›´æ¥åˆ é™¤æ•´ä¸ªæ–‡ä»¶å¤¹å³å¯" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "ç‰ˆæœ¬: v3.0" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        "æ„å»ºæ—¶é—´: $(Get-Date)" | Add-Content "release\ä¾¿æºç‰ˆè¯´æ˜.txt" -Encoding UTF8
        
        # å‹ç¼©ä¾¿æºç‰ˆ
        powershell Compress-Archive -Path "release\*" -DestinationPath "DHI_Screening_System_v3.0_Portable.zip" -Force
        
        Write-Host "âœ… ä¾¿æºç‰ˆåˆ›å»ºå®Œæˆ"
        
    - name: Upload Enhanced Installer
      uses: actions/upload-artifact@v4
      with:
        name: DHI_Enhanced_Installer
        path: installer/
        
    - name: Upload Portable Version
      uses: actions/upload-artifact@v4
      with:
        name: DHI_Portable_Version
        path: DHI_Screening_System_v3.0_Portable.zip
        
    - name: Create comprehensive release info
      run: |
        $buildTime = Get-Date
        
        # åˆ›å»ºæ„å»ºè¯´æ˜æ–‡æ¡£
        "# DHIç­›æŸ¥åˆ†æç³»ç»Ÿ v3.0 - å¢å¼ºå…¼å®¹æ€§æ„å»º" | Out-File -FilePath "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "## ğŸ¢ å¼€å‘å•ä½" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**ä¼Šåˆ©æ¶²å¥¶å¥¶ç§‘é™¢**" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "## ğŸ“¦ æ„å»ºäº§ç‰©" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "### 1. ğŸ¯ å¢å¼ºå®‰è£…åŒ…ï¼ˆæ¨èï¼‰" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**æ–‡ä»¶**: DHI_Screening_System_v3.0_Enhanced_Setup.exe" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**ç‰¹æ€§**:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… æ™ºèƒ½ç‰ˆæœ¬æ£€æµ‹å’Œå‡çº§" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… è‡ªåŠ¨å¸è½½æ—§ç‰ˆæœ¬" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… å®Œæ•´çš„Windowsé›†æˆ" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… å¼€å§‹èœå•ç¨‹åºç»„" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… æ¡Œé¢å¿«æ·æ–¹å¼ï¼ˆå¯é€‰ï¼‰" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… å®Œæ•´å¸è½½åŠŸèƒ½" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… 64ä½ç³»ç»Ÿä¼˜åŒ–" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "### 2. ğŸ’š ä¾¿æºç‰ˆæœ¬" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**æ–‡ä»¶**: DHI_Screening_System_v3.0_Portable.zip" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**ç‰¹æ€§**:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ’š å…å®‰è£…ç»¿è‰²ç‰ˆæœ¬" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ“‚ è§£å‹å³ç”¨" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ”“ æ— éœ€ç®¡ç†å‘˜æƒé™" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ“ æ•°æ®ä¿å­˜åœ¨ç¨‹åºç›®å½•" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ—‘ï¸ åˆ é™¤å³å¸è½½" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "## ğŸ–¥ï¸ ç³»ç»Ÿå…¼å®¹æ€§" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**æ”¯æŒçš„æ“ä½œç³»ç»Ÿ**:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… Windows 7 SP1 (64ä½)" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… Windows 8/8.1 (64ä½)" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… Windows 10 (64ä½)" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- âœ… Windows 11 (64ä½)" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**ç¡¬ä»¶è¦æ±‚**:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- **å¤„ç†å™¨**: 64ä½å¤„ç†å™¨" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- **å†…å­˜**: æœ€ä½2GBï¼Œæ¨è4GB+" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- **ç£ç›˜**: 500MBå¯ç”¨ç©ºé—´" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- **æ˜¾ç¤ºå™¨**: 1024x768åˆ†è¾¨ç‡" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**è½¯ä»¶ä¾èµ–**:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- æ— éœ€é¢å¤–å®‰è£…Pythonæˆ–å…¶ä»–è¿è¡Œæ—¶" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- å†…ç½®æ‰€æœ‰å¿…è¦ç»„ä»¶" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ä¼˜åŒ–çš„å¯åŠ¨æ€§èƒ½ï¼ˆ2-5ç§’ï¼‰" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "## ğŸš€ å®‰è£…ä½¿ç”¨æŒ‡å—" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "### å¢å¼ºå®‰è£…åŒ…å®‰è£…æ­¥éª¤:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "1. ä¸‹è½½ DHI_Screening_System_v3.0_Enhanced_Setup.exe" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "2. å³é”®é€‰æ‹©'ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ'" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "3. å¦‚æ£€æµ‹åˆ°æ—§ç‰ˆæœ¬ï¼Œé€‰æ‹©'æ˜¯'è‡ªåŠ¨å¸è½½" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "4. è·Ÿéšå®‰è£…å‘å¯¼å®Œæˆå®‰è£…" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "5. ä»å¼€å§‹èœå•å¯åŠ¨ç¨‹åº" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "### ä¾¿æºç‰ˆä½¿ç”¨æ­¥éª¤:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "1. ä¸‹è½½ DHI_Screening_System_v3.0_Portable.zip" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "2. è§£å‹åˆ°ä»»æ„ç›®å½•ï¼ˆå»ºè®®éç³»ç»Ÿç›˜ï¼‰" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "3. è¿è¡Œ DHI_Screening_System_v3.0.exe" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "4. é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆå§‹åŒ–é…ç½®" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "---" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**æ„å»ºä¿¡æ¯**:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ•’ æ„å»ºæ—¶é—´: $buildTime" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ—ï¸ æ„å»ºç¯å¢ƒ: GitHub Actions (Windows)" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ“¦ æ‰“åŒ…å·¥å…·: PyInstaller + Inno Setup" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "- ğŸ”§ ç‰ˆæœ¬æ ‡è¯†: v3.0-Enhanced" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "**ç‰ˆæƒä¿¡æ¯**:" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        "Copyright (C) 2025 ä¼Šåˆ©æ¶²å¥¶å¥¶ç§‘é™¢ ç‰ˆæƒæ‰€æœ‰" | Add-Content "æ„å»ºè¯´æ˜.txt" -Encoding UTF8
        
        Write-Host "âœ… æ„å»ºè¯´æ˜æ–‡æ¡£åˆ›å»ºå®Œæˆ"
        
    - name: Upload Build Documentation
      uses: actions/upload-artifact@v4
      with:
        name: Build_Documentation
        path: æ„å»ºè¯´æ˜.txt 