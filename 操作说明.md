# DHI精准筛查助手 - 操作说明

## 目录
1. [系统登录与账号管理](#系统登录与账号管理)
2. [主界面介绍](#主界面介绍)
3. [DHI基础筛选操作](#dhi基础筛选操作)
4. [隐性乳房炎监测](#隐性乳房炎监测)
5. [尿素氮追踪分析](#尿素氮追踪分析)
6. [数据源说明](#数据源说明)
7. [常见问题解答](#常见问题解答)

## 系统登录与账号管理

### 首次使用

1. **启动程序**
   - Windows: 双击 `DHI精准筛查助手.exe`
   - macOS/Linux: 运行 `python desktop_app.py`

2. **登录界面**
   - 登录窗口会自动置顶显示
   - 输入您的工号和密码
   - 勾选"记住密码"可保存登录信息

3. **新用户注册**
   - 点击"注册账号"按钮
   - 填写注册信息：
     - 工号：您的员工编号
     - 密码：至少6位，建议包含字母和数字
     - 姓名：您的真实姓名
     - 邀请码：向管理员申请获得
   - 点击"注册"完成账号创建

### 账号管理

1. **查看当前用户**
   - 主界面右上角显示当前登录用户的工号和姓名
   - 格式：`当前用户: 工号 (姓名)`

2. **注销登录**
   - 点击右上角"注销"按钮
   - 系统会安全退出并返回登录界面

3. **单设备登录限制**
   - 同一账号同时只能在一台设备上登录
   - 如需在新设备登录，会提示是否强制登录
   - 强制登录会使其他设备下线

4. **密码安全**
   - 本地密码使用加密存储
   - 建议定期更换密码
   - 不要分享账号给他人使用

## 主界面介绍

### 界面布局

主界面采用左右分栏设计：

**左侧控制面板** - 功能选择和参数设置
- 总体统计：显示当前数据概况
- 胎次分析：按胎次查看数据分布
- 蛋白率分析：蛋白率相关分析
- 体细胞数分析：体细胞数监测
- 其他性状：更多指标分析
- 计算方法：查看算法说明

**右侧结果面板** - 数据展示和结果输出
- 文件信息：显示已上传文件列表
- 处理过程：实时显示处理日志
- 筛选结果：展示分析结果
- 筛选分析：深度分析功能

### 界面设置

1. **显示设置**（菜单栏 -> 视图 -> 显示设置）
   - 界面缩放：50%-200%，适配不同分辨率
   - 字体设置：类型、大小、样式
   - 颜色设置：字体颜色、背景颜色
   - 主题跟随：自动适应系统主题

2. **快捷操作**
   - Ctrl+O：打开文件
   - Ctrl+S：保存结果
   - F5：刷新数据
   - F11：全屏显示

## DHI基础筛选操作

### 步骤1：上传DHI数据

1. **文件上传方式**
   - 点击"选择文件"按钮
   - 或直接拖拽文件到上传区域
   - 支持批量选择多个文件

2. **支持的文件格式**
   - ZIP压缩包：包含"综合测定结果表"的压缩文件
   - Excel文件：.xlsx 或 .xls 格式
   - 文件大小限制：单个文件不超过100MB

3. **文件命名规范**
   - 标准格式：`牧场编号(YYYY-MM)牧场名称.zip`
   - 示例：`151537(2025-07)向阳屯牧场.zip`
   - 系统会自动识别日期信息

### 步骤2：设置筛选条件

1. **基础筛选项**（必选）
   - **日期范围**：选择要分析的时间段
   - **胎次范围**：设置最小和最大胎次（1-8胎）
   - **牛场选择**：从下拉列表选择牛场（多选）

2. **性状筛选项**（可选）
   - 点击"添加筛选项"按钮
   - 从23种性状中选择需要筛选的指标
   - 设置各指标的范围值
   - 常用性状包括：
     - 蛋白率(%)：3.00-4.50
     - 乳脂率(%)：3.00-5.00
     - 体细胞数(万/ml)：0-50
     - 尿素氮(mg/dl)：5-30

3. **高级选项**
   - 连续月份要求：牛只需在几个月内都满足条件
   - 空值处理：是否将缺失值视为符合条件
   - 异常值过滤：自动排除明显异常的数据

### 步骤3：执行分析

1. **开始分析**
   - 确认所有条件设置正确
   - 点击"开始分析"按钮
   - 进度条会显示处理进度

2. **查看结果**
   - 分析完成后自动切换到"筛选结果"标签
   - 显示符合条件的牛只清单
   - 按月展示各项指标数据

3. **导出结果**
   - 点击"导出Excel"按钮
   - 选择保存位置和文件名
   - 导出的Excel包含：
     - 汇总统计表
     - 月度明细表
     - 牛只清单

## 隐性乳房炎监测

### 功能说明

隐性乳房炎监测通过分析体细胞数变化，帮助牧场：
- 及早发现潜在感染
- 追踪治疗效果
- 制定防控策略

### 操作步骤

1. **数据准备**
   - 确保已在"基础数据"标签上传DHI文件
   - 系统会自动使用已上传的数据

2. **参数设置**
   - **体细胞数阈值**：默认20万/ml，可调整
   - **慢性感染标准**：连续几个月超标判定为慢性
   - **分析月份**：选择要分析的时间范围

3. **牛群信息导入**（可选）
   - 上传牛群结构文件（支持伊起牛、慧牧云格式）
   - 用于计算更准确的感染率指标

4. **执行监测**
   - 点击"开始监测"按钮
   - 系统自动计算六大指标
   - 生成月度趋势图

5. **结果解读**
   - **当月流行率**：反映当前感染水平
   - **新发感染率**：评估疾病传播速度
   - **慢性感染率**：了解长期感染情况
   - **处置建议**：针对不同情况的应对方案

### 慢性感染牛处置

系统会根据感染情况提供5种处置建议：

1. **淘汰处置**：严重慢性感染，建议淘汰
2. **隔离治疗**：中度感染，需隔离治疗
3. **重点监控**：轻度感染，加强监测
4. **干奶期治疗**：接近干奶期，干奶时治疗
5. **正常管理**：暂无异常，常规管理

## 尿素氮追踪分析

### 功能说明

尿素氮是评估日粮蛋白质利用效率的重要指标：
- 正常范围：10-16 mg/dl
- 过低(<5)：蛋白质供应不足
- 过高(>30)：蛋白质过剩或利用率低

### 操作步骤

1. **数据选择**
   - 系统自动加载已上传的DHI数据
   - 显示可用的数据月份列表

2. **分组设置**
   - 选择要分析的泌乳阶段组
   - 默认包含所有12个阶段
   - 可根据需要选择特定阶段

3. **分析选项**
   - **筛选异常值**：只显示<5或>30的牛只
   - **最小样本量**：每组最少需要的牛只数
   - **加权平均**：使用产奶量加权计算平均值

4. **执行分析**
   - 点击"开始分析"按钮
   - 生成尿素氮变化趋势图
   - 显示各组统计数据

5. **结果导出**
   - 导出Excel包含：
     - 分组统计汇总
     - 趋势图表
     - 详细牛只清单
     - 异常值标记

### 结果应用

根据分析结果调整日粮配方：
- **新产期偏高**：降低日粮蛋白水平
- **高峰期偏低**：增加优质蛋白供应
- **整体偏高**：检查蛋白质来源和降解率
- **波动较大**：改善日粮稳定性

## 数据源说明

### DHI数据要求

1. **数据来源**
   - 各地DHI中心出具的正式检测报告
   - 包含"综合测定结果表"的Excel文件

2. **必需字段**
   - 管理号/牛号：牛只唯一标识
   - 胎次：当前胎次信息
   - 采样日期：DHI检测日期
   - 泌乳天数：产后天数
   - 产奶量：测定日产奶量
   - 蛋白率：乳蛋白百分比
   - 体细胞数：体细胞计数

3. **数据质量**
   - 确保数据完整性
   - 避免重复记录
   - 及时更新数据

### 牛群信息（可选）

支持导入以下系统的牛群数据：

1. **伊起牛系统**
   - 牛群结构查询导出
   - 发病查询导出
   - 产奶日汇总

2. **慧牧云系统**
   - 牛群数据管理导出
   - 发病事件管理导出

3. **自定义格式**
   - 包含牛号和在群状态
   - Excel格式，首行为表头

### 数据更新频率

- DHI数据：每月更新一次
- 牛群信息：每周更新
- 发病记录：实时更新

## 常见问题解答

### 登录问题

**Q: 忘记密码怎么办？**
A: 请联系系统管理员重置密码。

**Q: 提示"该账号已在其他设备登录"？**
A: 选择"强制登录"即可，之前的登录会被踢出。

### 数据上传问题

**Q: 上传文件失败？**
A: 检查文件格式是否正确，文件大小是否超限。

**Q: 找不到综合测定结果表？**
A: 系统支持多种命名，如"04-2综合测定结果表"、"04综合测定结果表"等。

### 分析结果问题

**Q: 为什么筛选结果为空？**
A: 检查筛选条件是否过严，尝试放宽条件范围。

**Q: 平均值计算方式？**
A: 采用产奶量加权平均，更准确反映实际情况。

### 导出问题

**Q: Excel导出失败？**
A: 确保有写入权限，关闭正在打开的同名文件。

**Q: 导出内容不完整？**
A: 检查是否所有分析都已完成，数据是否正常加载。

### 性能问题

**Q: 程序运行缓慢？**
A: 大量数据处理需要时间，建议分批处理。

**Q: 界面显示异常？**
A: 调整显示设置中的缩放比例和字体大小。

## 技术支持

如遇到无法解决的问题，请联系：
- 技术支持：伊利奶科院育种中心
- 邮箱：[技术支持邮箱]
- 电话：[技术支持电话]

请提供以下信息以便快速解决问题：
1. 问题描述和截图
2. 操作步骤
3. 错误提示信息
4. 使用的数据文件示例

---
*文档版本：v3.91*  
*更新日期：2025-07-18*